workflows:
  mais-tracker-simple:
    name: MaÃ¯s Tracker - Simple Build
    max_build_duration: 60
    environment:
      flutter: stable
      vars:
        FLUTTER_BUILD_MODE: release
        SQLITE_FFI_ENABLED: "true"
    scripts:
      - name: Set up local.properties
        script: |
          echo "flutter.sdk=$HOME/programs/flutter" > "$CM_BUILD_DIR/android/local.properties"
      - name: Get Flutter packages
        script: |
          flutter packages pub get
      - name: Flutter test (ignore warnings)
        script: |
          flutter test --no-sound-null-safety || echo "Tests failed, continuing..."
      - name: Build APK
        script: |
          flutter build apk --release
      - name: Build Linux
        script: |
          flutter build linux --release
      - name: Build Windows
        script: |
          flutter build windows --release
      - name: Build macOS
        script: |
          flutter build macos --release
    artifacts:
      - build/**/outputs/**/*.apk
      - build/linux/x64/release/bundle/*
      - build/windows/runner/Release/*
      - build/macos/Build/Products/Release/*.app
    publishing:
      email:
        recipients:
          - thierryber64@gmail.com
        notify:
          success: true
          failure: true
